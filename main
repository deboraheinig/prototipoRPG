#include <iostream>
#include <time.h>

struct arma {
	std::string nome;
	int danoMax;
	int danoMin;
};

struct jogador {
	int nivel;
	int vida;
	arma arma;
};

struct inimigo {
	std::string nome;
	int vida;
	arma arma;
};

struct fase {
	std::string nome;
	inimigo inimigos[5];
};

//Template para definir se o personagem morreu
template <typename T>
bool morreu(T personagem)
{
	if (personagem.vida < 0) {
		return true; // morto
	}
	else {
		return false; // vivo
	}
}

//Template para definir o dano gerado
template<typename Tata, typename Tdef>
Tdef ataque(Tata atacante, Tdef defensor) {
	//2 - 5
	int intervalo_dano = atacante.arma.danoMax - atacante.arma.danoMin + 1;
	int dano = atacante.arma.danoMin + rand() % intervalo_dano;

	defensor.vida = defensor.vida - dano;

	return defensor;
}

template <typename T>
T danoRand(T n1, T n2)
{
	int a = 0;
	while (a > n2 or a < n1) {
		// a função rand() gera um inteiro aleatório
		a = (n1 + (rand() % n2));
	}
	return a;
}


void jogar_fase(jogador jog, fase fase) {
	std::cout << "*===================================*" << std::endl;
	std::cout << "|  Entrando no " << fase.nome << "...  |" << std::endl;
	std::cout << "*===================================*" << std::endl;

	for (int atual = 0; atual < 5; atual++) {
		while (!morreu(fase.inimigos[atual])) {
			jog = ataque(fase.inimigos[atual], jog);
			fase.inimigos[atual] = ataque(jog, fase.inimigos[atual]);

			std::cout << "O inimigo " << fase.inimigos[atual].nome << " te atacou com um(a) " << fase.inimigos[atual].arma.nome << "." << std::endl;
			std::cout << "Vida jogador: " << jog.vida << std::endl;
			std::cout << "Voce atacou " << fase.inimigos[atual].nome << " com sua " << fase.inimigos[4].arma.nome << "." << std::endl;
			std::cout << "Vida inimigo: " << fase.inimigos[atual].vida << std::endl;
			std::cout << "" << std::endl;

			if (morreu(jog)) {
				std::cout << "O jogador morreu, o jogo acabou";
				std::cout << "*=======*" << std::endl;
				std::cout << "GAME OVER";
				std::cout << "*=======*" << std::endl;
				return;
			}
		}

		std::cout << fase.inimigos[atual].nome << " foi morto." << std::endl << std::endl;
	}
	std::cout << "*============================*" << std::endl;
	std::cout << "Parabens, voce passou de fase!" << std::endl;
	std::cout << "*============================*" << std::endl;
}


int main() {

	srand(time(NULL));


	fase fase;
	fase.nome = "Deserto do Saara";

	arma A[5];
	A[0].nome = "Canivete";
	A[0].danoMax = 5;
	A[0].danoMin = 1;

	A[1].nome = "Machado";
	A[1].danoMax = 15;
	A[1].danoMin = 5;

	A[2].nome = "Arco e flecha";
	A[2].danoMax = 20;
	A[2].danoMin = 10;

	A[3].nome = "Pistola";
	A[3].danoMax = 30;
	A[3].danoMin = 10;

	A[4].nome = "Espada";
	A[4].danoMax = 25;
	A[4].danoMin = 15;


	fase.inimigos[0].vida = 100;
	fase.inimigos[0].nome = "Golem";
	fase.inimigos[0].arma = A[0];

	fase.inimigos[1].vida = 30;
	fase.inimigos[1].nome = "Arara";
	fase.inimigos[1].arma = A[1];

	fase.inimigos[2].vida = 80;
	fase.inimigos[2].nome = "Bandido";
	fase.inimigos[2].arma = A[2];

	fase.inimigos[3].vida = 60;
	fase.inimigos[3].nome = "Coveiro";
	fase.inimigos[3].arma = A[3];

	fase.inimigos[4].vida = 120;
	fase.inimigos[4].nome = "Pedreiro";
	fase.inimigos[4].arma = A[4];


	jogador jog = { 1, 400, A[4]};
	jog.arma = A[4];

	jogar_fase(jog, fase);
	
}
